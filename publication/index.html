---
layout: default
baseurl: /publication
title: Publication
---

{% assign category = site.data.publication-category %}

<style>
  [type=radio] {
    display: none !important;
  }

  {% for type in category.types %}
  #tag-{{ type | replace: ' ', '' }}:checked ~ .tag-label#label-{{ type | replace: ' ', '' }},
  {% endfor %}
  #tag-all:checked ~ .tag-label#label-all {
    text-decoration: underline;
    font-weight: 500;
  }

  {% for type in category.types %}
  #tag-all:checked ~ #publications > .item:not(.item) {
    display: none !important;
  }
  #tag-{{ type | replace: ' ', '' }}:checked ~ #publications > .item:not(.tag-{{ type | replace: ' ', '' }}) {
    display: none !important;
  }
  {% endfor %}

  .project-view {
    padding-top: .5rem;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }

  @media (min-width:48.0625em) {
    .project-view {
      justify-content: center;
    }
  }

  .item:last-child > hr {
    display: none;
  }

  /* New CSS to hide the bottom border of the last publication */
  .no-border {
    display: none !important;
  }

  .publication-year:first {
    padding-top: 0 !important
  }
</style>

<div class="container py-4">
  <div class="row pb-3">
    <div class="col-md-4">
      <p style="font-weight: 500 !important; text-transform: uppercase;">Publications</p>
    </div>
  </div>

  <div class="project-view">
    <input type="radio" name="tag" id="tag-all" aria-labelledby="tag-all" checked>
    {% for cat in category.types %}
    <input type="radio" name="tag" id="tag-{{ cat | replace: ' ', '' }}" aria-labelledby="tag-{{ cat | replace: ' ', '' }}">
    {% endfor %}

    <label style="font-size: .95rem !important; cursor: pointer" for="tag-all" class="tag-label tag-all" id="label-all">All</label>
    {% for cat in category.types %}
    <label style="font-size: .95rem !important; cursor: pointer" for="tag-{{ cat | replace: ' ', '' }}" class="ml-3 tag-label tag-{{ cat | replace: ' ', '' }}" id="label-{{ cat | replace: ' ', '' }}">{{ cat }}</label>
    {% endfor %}

    <div class="row mt-4" style="flex: 0 0 100%;" id="publications">
      <!-- JavaScript will inject items here -->
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
  async function fetchPublications() {
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRp7c-CvHjVhOEVjA3Dp9YPOpIZIlADn6K66pcwhIiQKUDUShi9CcXE-JO6RNNPCL8u8MX1OR1r-RqV/pub?gid=0&single=true&output=csv";
    const response = await fetch(csvUrl);
    const csvText = await response.text();
    // Changed header: true to header: false to access by index
    const data = Papa.parse(csvText, { header: false }).data;

    const container = document.getElementById("publications");

    // Remove header row if present (assuming the first row is header)
    // You might need to adjust this based on your CSV structure
    const publicationsData = data.slice(1); // Skip the first row (headers)

    // Group publications by year (Year is now at index 0)
    const groupedByYear = publicationsData.reduce((acc, pub) => {
      // Access year by index 0
      const year = pub[0] || "Unknown Year";
      if (!acc[year]) {
        acc[year] = [];
      }
      acc[year].push(pub);
      return acc;
    }, {});

    // Sort years in descending order
    const sortedYears = Object.keys(groupedByYear).sort((a, b) => b - a);

    // Generate HTML for each year and its publications
    sortedYears.forEach(year => {
      const yearDiv = document.createElement("div");
      yearDiv.className = "col-12 px-0";
      yearDiv.innerHTML = `<p class="publication-year pt-4 pb-2" style="font-size: .95rem; font-weight: 400;">${year}</p>`;
      container.appendChild(yearDiv);

      const publications = groupedByYear[year];
      publications.forEach((pub, index) => {
        const div = document.createElement("div");
        // Access Category by index 6
        const categories = (pub[6] || "")
          .split(",")
          .map(c => `tag-${c.trim().replace(/\s/g, "")}`)
          .join(" ");
        div.className = `item col-12 px-0 ${categories}`;

        div.innerHTML = `
          <p class="mb-1" style="font-size: 1rem; font-weight: 400 !important;">${pub[1] || ''}</p>
          <p class="mb-1" style="font-size: .95rem; font-weight: 200 !important;">${pub[2] || ''}</p>
          <p class="mb-2" style="font-size: .95rem; font-weight: 300 !important;">${pub[3] || ''}${pub[4] ? `: ${pub[4]}` : ''}</p>
          ${pub[7] ? `<p class="mb-1" style="font-size: .95rem; font-weight: 300 !important;"><i class="fa-solid fa-medal"></i>&nbsp;&nbsp;${pub[7]}</p>` : ''}
          <p style="font-size: .9rem; font-weight: 300 !important;">
            ${pub[5] ? `<a href="/assets/pdf/publications/${pub[5]}"><i class="fa-solid fa-file"></i>&nbsp;&nbsp;PDF</a>&nbsp;&nbsp;&nbsp;&nbsp;` : ''}
            ${pub[8] ? `<a href="${pub[8]}"><i class="fa-solid fa-play"></i>&nbsp;&nbsp;Video</a>&nbsp;&nbsp;&nbsp;&nbsp;` : ''}
            ${pub[9] ? `<a href="${pub[9]}"><i class="fa-solid fa-file-powerpoint"></i>&nbsp;&nbsp;Slides</a>&nbsp;&nbsp;&nbsp;&nbsp;` : ''}
          </p>
          <hr>
        `;

        // Add class to last item of the year
        if (index === publications.length - 1) {
          div.querySelector('hr').classList.add('no-border');
        }

        container.appendChild(div);
      });
    });
  }

  document.addEventListener("DOMContentLoaded", fetchPublications);
</script>